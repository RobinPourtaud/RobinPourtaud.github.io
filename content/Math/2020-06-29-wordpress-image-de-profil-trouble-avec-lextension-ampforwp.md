---
title: 'WordPress – Image de profil trouble avec l&rsquo;extension AMPforWP'
author: Robin Pourtaud
type: post
date: 2020-06-29T09:00:00+00:00
url: /sciences/informatique/robin/3258/
featured_image: /wp-content/uploads/2020/06/Image-trouble-1568x223.png
rank_math_seo_score:
  - "69"
rank_math_primary_category:
  - "8"
ads-for-wp-visibility:
  - show
itemlist_item_2757:
  - 'a:0:{}'
music_composer_2757:
  - 'a:0:{}'
movie_actor_2757:
  - 'a:0:{}'
article_items_2757:
  - 'a:0:{}'
image_object_exif_data_2757:
  - 'a:0:{}'
blogposting_items_2757:
  - 'a:0:{}'
newsarticle_items_2757:
  - 'a:0:{}'
tech_article_items_2757:
  - 'a:0:{}'
product_reviews_2757:
  - 'a:0:{}'
feed_element_2757:
  - 'a:0:{}'
faq_question_2757:
  - 'a:0:{}'
performer_2757:
  - 'a:0:{}'
organizer_2757:
  - 'a:0:{}'
accepted_answer_2757:
  - 'a:0:{}'
suggested_answer_2757:
  - 'a:0:{}'
howto_supply_2757:
  - 'a:0:{}'
howto_tool_2757:
  - 'a:0:{}'
howto_step_2757:
  - 'a:0:{}'
announcement_location_2757:
  - 'a:0:{}'
music_playlist_track_2757:
  - 'a:0:{}'
music_album_track_2757:
  - 'a:0:{}'
apartment_amenities_2757:
  - 'a:0:{}'
additional_property_2757:
  - 'a:0:{}'
mc_cause_2757:
  - 'a:0:{}'
mc_symptom_2757:
  - 'a:0:{}'
mc_risk_factor_2757:
  - 'a:0:{}'
tvseries_actor_2757:
  - 'a:0:{}'
tvseries_season_2757:
  - 'a:0:{}'
trip_itinerary_2757:
  - 'a:0:{}'
itemlist_item_1877:
  - 'a:0:{}'
music_composer_1877:
  - 'a:0:{}'
movie_actor_1877:
  - 'a:0:{}'
article_items_1877:
  - 'a:0:{}'
image_object_exif_data_1877:
  - 'a:0:{}'
blogposting_items_1877:
  - 'a:0:{}'
newsarticle_items_1877:
  - 'a:0:{}'
tech_article_items_1877:
  - 'a:0:{}'
product_reviews_1877:
  - 'a:0:{}'
feed_element_1877:
  - 'a:0:{}'
faq_question_1877:
  - 'a:0:{}'
performer_1877:
  - 'a:0:{}'
organizer_1877:
  - 'a:0:{}'
accepted_answer_1877:
  - 'a:0:{}'
suggested_answer_1877:
  - 'a:0:{}'
howto_supply_1877:
  - 'a:0:{}'
howto_tool_1877:
  - 'a:0:{}'
howto_step_1877:
  - 'a:0:{}'
announcement_location_1877:
  - 'a:0:{}'
music_playlist_track_1877:
  - 'a:0:{}'
music_album_track_1877:
  - 'a:0:{}'
apartment_amenities_1877:
  - 'a:0:{}'
additional_property_1877:
  - 'a:0:{}'
mc_cause_1877:
  - 'a:0:{}'
mc_symptom_1877:
  - 'a:0:{}'
mc_risk_factor_1877:
  - 'a:0:{}'
tvseries_actor_1877:
  - 'a:0:{}'
tvseries_season_1877:
  - 'a:0:{}'
trip_itinerary_1877:
  - 'a:0:{}'
itemlist_item_1494:
  - 'a:0:{}'
music_composer_1494:
  - 'a:0:{}'
movie_actor_1494:
  - 'a:0:{}'
article_items_1494:
  - 'a:0:{}'
image_object_exif_data_1494:
  - 'a:0:{}'
blogposting_items_1494:
  - 'a:0:{}'
newsarticle_items_1494:
  - 'a:0:{}'
tech_article_items_1494:
  - 'a:0:{}'
product_reviews_1494:
  - 'a:0:{}'
feed_element_1494:
  - 'a:0:{}'
faq_question_1494:
  - 'a:0:{}'
performer_1494:
  - 'a:0:{}'
organizer_1494:
  - 'a:0:{}'
accepted_answer_1494:
  - 'a:0:{}'
suggested_answer_1494:
  - 'a:0:{}'
howto_supply_1494:
  - 'a:0:{}'
howto_tool_1494:
  - 'a:0:{}'
howto_step_1494:
  - 'a:0:{}'
announcement_location_1494:
  - 'a:0:{}'
music_playlist_track_1494:
  - 'a:0:{}'
music_album_track_1494:
  - 'a:0:{}'
apartment_amenities_1494:
  - 'a:0:{}'
additional_property_1494:
  - 'a:0:{}'
mc_cause_1494:
  - 'a:0:{}'
mc_symptom_1494:
  - 'a:0:{}'
mc_risk_factor_1494:
  - 'a:0:{}'
tvseries_actor_1494:
  - 'a:0:{}'
tvseries_season_1494:
  - 'a:0:{}'
trip_itinerary_1494:
  - 'a:0:{}'
itemlist_item_1493:
  - 'a:0:{}'
music_composer_1493:
  - 'a:0:{}'
movie_actor_1493:
  - 'a:0:{}'
article_items_1493:
  - 'a:0:{}'
image_object_exif_data_1493:
  - 'a:0:{}'
blogposting_items_1493:
  - 'a:0:{}'
newsarticle_items_1493:
  - 'a:0:{}'
tech_article_items_1493:
  - 'a:0:{}'
product_reviews_1493:
  - 'a:0:{}'
feed_element_1493:
  - 'a:0:{}'
faq_question_1493:
  - 'a:0:{}'
performer_1493:
  - 'a:0:{}'
organizer_1493:
  - 'a:0:{}'
accepted_answer_1493:
  - 'a:0:{}'
suggested_answer_1493:
  - 'a:0:{}'
howto_supply_1493:
  - 'a:0:{}'
howto_tool_1493:
  - 'a:0:{}'
howto_step_1493:
  - 'a:0:{}'
announcement_location_1493:
  - 'a:0:{}'
music_playlist_track_1493:
  - 'a:0:{}'
music_album_track_1493:
  - 'a:0:{}'
apartment_amenities_1493:
  - 'a:0:{}'
additional_property_1493:
  - 'a:0:{}'
mc_cause_1493:
  - 'a:0:{}'
mc_symptom_1493:
  - 'a:0:{}'
mc_risk_factor_1493:
  - 'a:0:{}'
tvseries_actor_1493:
  - 'a:0:{}'
tvseries_season_1493:
  - 'a:0:{}'
trip_itinerary_1493:
  - 'a:0:{}'
rank_math_internal_links_processed:
  - "1"
ampforwp-amp-on-off:
  - default
rank_math_focus_keyword:
  - trouble
rank_math_analytic_object_id:
  - "45"
categories:
  - Informatique
tags:
  - Wordpress

---
Durant l&rsquo;installation de notre site web, nous avions décidé d&rsquo;utiliser l&rsquo;extension AMPforWP pour accélérer et faciliter notre référencement sur Google. Bien sûr, nous avons rencontré de nombreux problèmes. L&rsquo;un d&rsquo;entre eux était l&rsquo;apparition de photos de profil troubles pour le bloc d&rsquo;auteur (« author box ») . 

## Le problème : 

On peut voir avec le screenshot suivant que _AMP for WP_ demande à Gravatar une image de taille s=70 car la taille du bloc est de taille 70 (dans notre cas).<figure class="wp-block-image size-large">

<img loading="lazy" width="1024" height="129" src="https://keskec.fr/wp-content/uploads/2020/06/image-8-1024x129.png" alt="" class="wp-image-3262" srcset="https://keskec.fr/wp-content/uploads/2020/06/image-8-1024x129.png 1024w, https://keskec.fr/wp-content/uploads/2020/06/image-8-300x38.png 300w, https://keskec.fr/wp-content/uploads/2020/06/image-8-768x97.png 768w, https://keskec.fr/wp-content/uploads/2020/06/image-8-1536x193.png 1536w, https://keskec.fr/wp-content/uploads/2020/06/image-8-2048x258.png 2048w, https://keskec.fr/wp-content/uploads/2020/06/image-8-1568x197.png 1568w" sizes="(max-width: 1024px) 100vw, 1024px" /> </figure> 

Cependant, une image Gravatar de taille s=70 a tendance à être trouble. 

Malheureusement, l&rsquo;extension AMPforWP (actuellement en version : 1.0.53.1) ne le permet pas depuis les paramètres : 

<div class="wp-block-image">
  <figure class="aligncenter size-large is-resized"><img loading="lazy" src="https://keskec.fr/wp-content/uploads/2020/06/image-9-1024x566.png" alt="" class="wp-image-3263" width="557" height="307" srcset="https://keskec.fr/wp-content/uploads/2020/06/image-9-1024x566.png 1024w, https://keskec.fr/wp-content/uploads/2020/06/image-9-300x166.png 300w, https://keskec.fr/wp-content/uploads/2020/06/image-9-768x425.png 768w, https://keskec.fr/wp-content/uploads/2020/06/image-9-1536x849.png 1536w, https://keskec.fr/wp-content/uploads/2020/06/image-9-1568x867.png 1568w, https://keskec.fr/wp-content/uploads/2020/06/image-9.png 1655w" sizes="(max-width: 557px) 100vw, 557px" /><figcaption>Author Bio &#8211; AMPforWP</figcaption></figure>
</div>

## La solution : 

Accédez par la méthode de votre choix à la racine de votre site web puis ouvrez le fichier suivant (par la méthode de votre choix, SSH, FTP, &#8230;). 

<p class="has-text-align-center">
  ~/wp-content/plugins/accelerated-mobile-pages/components/author-box/author-box.php
</p>

Remplacez (à la ligne 92 pour moi) cette partie du fichier : 

<pre class="wp-block-code" aria-describedby="shcb-language-97" data-shcb-language-name="PHP" data-shcb-language-slug="php"><div>
  <code class="hljs language-php">&lt;span class="hljs-keyword">if&lt;/span> ( &lt;span class="hljs-keyword">null&lt;/span> == $author_avatar_url ){
         $author_avatar_url = get_avatar_url( $post_author-&gt;ID, &lt;span class="hljs-keyword">array&lt;/span>( &lt;span class="hljs-string">'size'&lt;/span> =&gt; $avatar_size ) );
  } </code>
</div>

<small class="shcb-language" id="shcb-language-97"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>

Par :

<pre class="wp-block-code" aria-describedby="shcb-language-98" data-shcb-language-name="PHP" data-shcb-language-slug="php"><div>
  <code class="hljs language-php">&lt;span class="hljs-keyword">if&lt;/span> ( &lt;span class="hljs-keyword">null&lt;/span> == $author_avatar_url ){
         $avatar_new_size = $avatar_size + &lt;span class="hljs-number">100&lt;/span>;
         $author_avatar_url = get_avatar_url( $post_author-&gt;ID, &lt;span class="hljs-keyword">array&lt;/span>( &lt;span class="hljs-string">'size'&lt;/span> =&gt; $avatar_new_size ) );
  } </code>
</div>

<small class="shcb-language" id="shcb-language-98"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>

Arbitrairement, j&rsquo;ai choisi de prendre une taille supérieure de 100 pixels à la taille originale. Vous pouvez bien sûr modifier ce nombre selon votre besoin. 

_Note : Il faut savoir qu&rsquo;une mise a jour peut effacer cette modification manuelle. Il faudra donc certainement le refaire&#8230;_